---
title: "Restaurant analisyes"
output: html_document
---
#About the data

Historical data of demand for a product-center combination (Weeks: 1 to 145)
Product(Meal) features such as category, sub-category, current price and discount
Information for fulfillment centers like center area, city information, etc.

Source:
https://www.kaggle.com/gauravsahani/food-demand-prediction-dataset

```{r}
#package required
library(tidyverse)
library(dplyr)
library(ggplot2)

#data
food <- read.csv("Food_demand.csv")
```

```{r}

#get to know your data
summary(food)
glimpse(food)
```

```{r}
#How much is the restaurant income ?
income <- sum(food$checkout_price)

#What is minimum and maximum check out price Weakly?

 weeks<- food %>% 
          group_by(week) %>% 
          summarise( weeklyCheckout = sum(checkout_price))

max(weeks$weeklyCheckout)
min(weeks$weeklyCheckout)
```


```{r}
#Which dish gives the most income?
mealID <- food %>% 
         group_by(meal_id) %>% 
         summarise(checkoutPrice = sum(checkout_price))

ggplot(mealID, aes(meal_id, checkoutPrice ))+
  geom_point()

range(mealID$checkoutPrice)

```


```{r}
#How stable is the weekly chick out price ?

weeklyChekout <- food %>% 
                 group_by(week) %>% 
                 summarise(checkoutPrice = sum(checkout_price))

ggplot(weeklyChekout, aes(x= checkoutPrice))+
  geom_histogram()

#mean
checkoutMean <- mean(weeklyChekout$checkoutPrice)

#sd
checkoutSd <- sd(weeklyChekout$checkoutPrice)

# SEM 
SEM <- checkoutSd/sqrt(length(weeklyChekout))

# 95% CI
CI_lower <- checkoutMean - (1.96 * SEM)
CI_upper <- checkoutMean + (1.96 * SEM)


```


```{r}
#Which restaurant center is more popular by the number of orders?

centerID <- food %>% 
            group_by(center_id) %>%
            filter(num_orders <5000) %>% 
            summarise(numOrders = sum(num_orders))

ggplot(centerID, aes(center_id, numOrders))+
  geom_point()


max(centerID$numOrders)

min(centerID$numOrders)


```
There is high difference between the number of orders of the centers.

```{r}
#How does the centerID influence the number of orders ?
lm_food <- lm(checkout_price ~ center_id, data = food)
summary(lm_food)
coef(lm_food)
```


```{r}
#How is the weekly orders of one center ?
 
centerIncome10 <- food %>% 
  group_by(week) %>% 
  filter(center_id == 10) %>% 
  summarise(num_orders)  

ggplot(centerIncome10, aes(week, num_orders))+
  geom_point()+
  geom_smooth(method = "lm", col = "blue",se = F)

mean(centerIncome10$num_orders)

#Variance
sd(centerIncome10$num_orders)
```
In this center the liner is going up by variation of 599.

```{r}
#another center
centerIncome23 <- food %>% 
  group_by(week) %>% 
  filter(center_id == 23) %>% 
  summarise(num_orders)

ggplot(centerIncome23, aes(week, num_orders))+
  geom_point()+
  geom_smooth(method = "lm", col = "blue",se = F)

mean(centerIncome23$num_orders)

#Variance
sd(centerIncome23$num_orders)

```


```{r}
#all centers

centerIncomeAll <- food %>% 
  group_by(week) %>%
  filter(num_orders < 1000) %>% 
  summarise(allOrders = sum(num_orders))

ggplot(centerIncomeAll, aes(week, allOrders))+
  geom_point()+
  geom_smooth(method = "lm", col = "blue",se = F)
  
mean(centerIncomeAll$num_orders)

#Variance 

sd(centerIncomeAll$allOrders)
```
We noticed that the orders are going slightly up in general through the time with variation of 1010.7 


